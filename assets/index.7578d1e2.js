import{A as j,T as m,S as g,G as v,a as d}from"./vendor.a8b119e9.js";const w=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function e(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerpolicy&&(s.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?s.credentials="include":t.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(t){if(t.ep)return;t.ep=!0;const s=e(t);fetch(t.href,s)}};w();const r=new j({width:640,height:360,backgroundColor:16777215});document.getElementById("main").appendChild(r.view);r.stage.sortableChildren=!0;const b={missile:m.from("texture/missile.png"),aim1:m.from("texture/aim1.png"),aim2:m.from("texture/aim2.png"),target:m.from("texture/target.png"),explosion:m.from("texture/explosion.png")};class u{constructor(o,e,i,t){this.x=o,this.y=e,this.w=i,this.h=t,this.player=new C(o+i/2,e+t*.1,[o,e,o+i-16,e+t/3]),this.target=new I(o+i/2,e+t*.1+50*Math.random(),[o+i/2-50,e,o+i/2+50,e+t/3]),this.missiles=new Array,this.missileInterval=0,this.nearby=!1;const s=new v;s.position.x=o,s.position.y=e,s.lineStyle(1,0,1),s.drawRect(0,0,i,t),r.stage.addChild(s),this.frame=s}update(o,e){this.missiles.map(i=>i.update()),this.missiles=this.missiles.filter(i=>i.obj.position.y>this.y?!0:(i.remove(),!1)),this.player.update(e),this.target.update(e);{let i=!1;const t=10,s=60;this.missiles.map(l=>{const f=l.obj.position.x+8;this.target.obj.position.x-t<f&&f<this.target.obj.position.x+16+t&&this.target.obj.position.y<l.obj.position.y&&l.obj.position.y<this.target.obj.position.y+16+s&&(i=!0)}),this.nearby=i}{const i=20,t=20,s=this.player.obj.position.x+8;this.target.obj.position.x-i<s&&s<this.target.obj.position.x+16+i&&this.target.obj.position.y-t<this.player.obj.position.y&&this.player.obj.position.y<this.target.obj.position.y+16+t?(this.player.active=!0,this.player.obj.texture=b.aim2):(this.player.active=!1,this.player.obj.texture=b.aim1)}this.missiles.map(i=>{const t=i.obj.position.x+8;if(this.target.obj.position.x<t&&t<this.target.obj.position.x+16&&this.target.obj.position.y<i.obj.position.y&&i.obj.position.y<this.target.obj.position.y+16){const s=new d.from(b.explosion);s.position.x=this.target.obj.position.x,s.position.y=this.target.obj.position.y,r.stage.addChild(s),r.ticker.stop()}}),this.missileInterval>0&&(this.missileInterval-=o)}}class I{constructor(o,e,i){this.bbox=i,this.obj=new d.from(b.target),this.obj.position.x=o-8,this.obj.position.y=e-8,r.stage.addChild(this.obj),this.dx=.5,this.dy=0}update(){let o=this.obj.position.x+this.dx;(o<this.bbox[0]||o>this.bbox[2])&&(this.dx*=-1),this.obj.position.x+=this.dx}}const y=new g;class C{constructor(o,e,i){this.active=!1,this.bbox=i,this.obj=new d.from(b.aim1),this.obj.zIndex=100,this.obj.position.x=o-8,this.obj.position.y=e-8,r.stage.addChild(this.obj),this.a=Math.random()*100,this.b=Math.random()*100}update(o){let e={x:this.obj.position.x+y.noise2D(this.a,o*.01)*1,y:this.obj.position.y+y.noise2D(this.b,o*.01)*1};e.x=Math.min(Math.max(this.bbox[0],e.x),this.bbox[2]),e.y=Math.min(Math.max(this.bbox[1],e.y),this.bbox[3]),this.obj.position.x=e.x,this.obj.position.y=e.y}}class x{constructor(o,e){this.obj=new d.from(b.missile),this.obj.zIndex=90,this.obj.position.x=o,this.obj.position.y=e,r.stage.addChild(this.obj),this.dx=0,this.dy=-4}update(){this.obj.position.x+=this.dx,this.obj.position.y+=this.dy}remove(){r.stage.removeChild(this.obj),this.obj=null}}const a=10,h=new u(a+0,a+0,320-a*2,360-a*2),p=new u(a+320,a+0,320-a*2,360-a*2);document.addEventListener("keydown",n=>{n.key==="a"?h.missileInterval<=0&&h.player.active&&(h.missileInterval=80,h.missiles.push(new x(h.player.obj.position.x,h.h))):n.key==="l"&&p.missileInterval<=0&&p.player.active&&(p.missileInterval=80,p.missiles.push(new x(p.player.obj.position.x,p.h)))});let c=0;r.ticker.add(n=>{c+=n,h.update(n,c),p.update(n,c),h.nearby&&p.nearby&&r.ticker.stop()});
